{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "[DEPLOY] Ansible Playbook: Run playbook",
      "type": "shell",
      "command": "docker run --rm --name ansible-dev -u root -v ~/bundle-ca.crt:/certs/bundle-ca.crt -v /repo:/repo -v ~/.profile:/root/.profile ${input:ansible_image} bash -c 'cd ${workspaceFolder} && bash /repo/pl.rachuna-net/tools/scripts/vscode/deploy/ansible_playbooks_all.bash'",
      "args": [],
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[DEPLOY] Ansible Playbook: Test connections",
      "type": "shell",
      "command": "docker run --rm --name ansible-dev -u root -v ~/bundle-ca.crt:/certs/bundle-ca.crt -v ~/.profile:/root/.profile ${input:ansible_image} bash -c 'cd ${workspaceFolder} && bash /repo/pl.rachuna-net/tools/scripts/vscode/deploy/ansible_playbook_test_connection.bash'",
      "args": [],
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[DEPLOY] terraform apply",
      "type": "shell",
      "command": "docker run --rm --name terraform-dev -u root -v /repo:/repo -v ~/.ssh/gitlab-runner:/root/.ssh/gitlab-runner -v ~/.profile:/root/.profile ${input:terraform_image} sh -c 'cd ${workspaceFolder} && bash /repo/pl.rachuna-net/tools/scripts/vscode/deploy/tearraform.bash'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[DEVELOPER] consul cli",
      "type": "shell",
      "command": "docker run -it --name consul-dev -u root -v /repo:/repo -v ~/.profile:/root/.profile ${input:consul_image} sh -c 'cd ${workspaceFolder} && bash /repo/pl.rachuna-net/tools/scripts/vscode/developer/consul.bash && exec bash' && docker rm consul-dev",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "[DEVELOPER] vault cli",
      "type": "shell",
      "command": "docker run -it --name vault-dev -u root -v /repo:/repo -v ~/.profile:/root/.profile ${input:vault_image} sh -c 'cd ${workspaceFolder} && bash /repo/pl.rachuna-net/tools/scripts/vscode/developer/vault.bash && exec bash' && docker rm vault-dev",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "[DISCIPLINE] Create .gitlab/badges.md",
      "type": "shell",
      "command": "bash /repo/pl.rachuna-net/tools/scripts/vscode/gitlab/generate-badged.bash",
      "runOptions": {
        "runOn": "folderOpen"
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[DISCIPLINE] Generate README.md",
      "type": "shell",
      "command": "bash /repo/pl.rachuna-net/tools/scripts/vscode/gitlab/generate-readme.bash",
      "options": {
        "env": {
          "REPOSITORY_ROOT_PATH": "/repo"
        }
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[DISCIPLINE] Update .gitlab files",
      "type": "shell",
      "command": "bash /repo/pl.rachuna-net/tools/scripts/vscode/gitlab/update-gitlab-files.bash",
      "options": {
        "env": {
          "REPOSITORY_ROOT_PATH": "/repo"
        }
      },
      "runOptions": {
        "runOn": "folderOpen"
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[DISCIPLINE] Update Docker images",
      "type": "shell",
      "command": "bash /repo/pl.rachuna-net/tools/scripts/vscode/general/update_docker_tags.bash",
      "problemMatcher": [],
      "runOptions": {
        "runOn": "folderOpen"
      }
    },
    {
      "label": "[mkDocs] Start MkDocs Service",
      "type": "shell",
      "command": "docker run --rm --name mkdocs-dev -p 8000:8000 -v ${workspaceFolder}:/docs ${input:mkdocs_image} sh -c 'mkdocs build && mkdocs serve -a 0.0.0.0:8000'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[UNIT-TEST] Molecule Test",
      "type": "shell",
      "command": "docker run --rm --name ansible-dev -u root -v /repo:/repo -v ~/.profile:/root/.profile -v ~/.ssh/packer:/root/.ssh/packer ${input:ansible_image} sh -c 'cd ${workspaceFolder} && bash /repo/pl.rachuna-net/tools/scripts/vscode/unit-test/molecule_test.bash'",
      "args": [],
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[VALIDATE] terraform fmt and validate",
      "type": "shell",
      "command": "docker run --rm --name terraform-dev -u root -v /repo:/repo -v ~/.ssh/gitlab-runner:/root/.ssh/gitlab-runner -v ~/.profile:/root/.profile ${input:terraform_image} sh -c 'cd ${workspaceFolder} && bash /repo/pl.rachuna-net/tools/scripts/vscode/validate/terraform.bash'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[VALIDATE] yamllint",
      "type": "shell",
      "command": "docker run --rm --name python-dev -u root -v /repo:/repo -v ~/.profile:/root/.profile ${input:python_image} sh -c 'cd ${workspaceFolder} && bash /repo/pl.rachuna-net/tools/scripts/vscode/validate/yamllint.bash'",
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },
    {
      "label": "[VSCODE] Generate .vscode/tasks.json",
      "type": "shell",
      "command": "bash /repo/pl.rachuna-net/tools/scripts/vscode/general/generate_tasks.bash",
      "runOptions": {
        "runOn": "folderOpen"
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    }
  ],
  "inputs": [
    {
      "id": "ansible_image",
      "type": "pickString",
      "description": "Ansible docker image",
      "options": [
        "registry.gitlab.com/pl.rachuna-net/containers/ansible:1.0.0",
        "registry.gitlab.com/pl.rachuna-net/containers/ansible:1.0.1"
      ],
      "default": "registry.gitlab.com/pl.rachuna-net/containers/ansible:1.0.1"
    },
    {
      "id": "consul_image",
      "type": "pickString",
      "description": "consul docker image",
      "options": [
        "registry.gitlab.com/pl.rachuna-net/containers/consul:1.0.0"
      ],
      "default": "registry.gitlab.com/pl.rachuna-net/containers/consul:1.0.0"
    },
    {
      "id": "mkdocs_image",
      "type": "pickString",
      "description": "MkDocs docker image",
      "options": [
        "registry.gitlab.com/pl.rachuna-net/containers/mkdocs:1.0.0",
        "registry.gitlab.com/pl.rachuna-net/containers/mkdocs:1.0.1",
        "registry.gitlab.com/pl.rachuna-net/containers/mkdocs:1.0.2"
      ],
      "default": "registry.gitlab.com/pl.rachuna-net/containers/mkdocs:1.0.2"
    },
    {
      "id": "packer_image",
      "type": "pickString",
      "description": "Packer docker image",
      "options": [
        "registry.gitlab.com/pl.rachuna-net/containers/packer:1.0.0",
        "registry.gitlab.com/pl.rachuna-net/containers/packer:1.0.1",
        "registry.gitlab.com/pl.rachuna-net/containers/packer:1.0.2",
        "registry.gitlab.com/pl.rachuna-net/containers/packer:v1.0.1-8e891ee5"
      ],
      "default": "registry.gitlab.com/pl.rachuna-net/containers/packer:v1.0.1-8e891ee5"
    },
    {
      "id": "python_image",
      "type": "pickString",
      "description": "Python docker image",
      "options": [
        "registry.gitlab.com/pl.rachuna-net/containers/python:1.0.0",
        "registry.gitlab.com/pl.rachuna-net/containers/python:1.0.1",
        "registry.gitlab.com/pl.rachuna-net/containers/python:1.0.2"
      ],
      "default": "registry.gitlab.com/pl.rachuna-net/containers/python:1.0.2"
    },
    {
      "id": "semantic_release_image",
      "type": "pickString",
      "description": "semantic-release docker image",
      "options": [
        "registry.gitlab.com/pl.rachuna-net/containers/semantic-release:1.0.0",
        "registry.gitlab.com/pl.rachuna-net/containers/semantic-release:1.0.1"
      ],
      "default": "registry.gitlab.com/pl.rachuna-net/containers/semantic-release:1.0.1"
    },
    {
      "id": "sonar_scanner_image",
      "type": "pickString",
      "description": "sonar-scanner docker image",
      "options": [
        "registry.gitlab.com/pl.rachuna-net/containers/sonar-scanner:1.0.0",
        "registry.gitlab.com/pl.rachuna-net/containers/sonar-scanner:1.0.1"
      ],
      "default": "registry.gitlab.com/pl.rachuna-net/containers/sonar-scanner:1.0.1"
    },
    {
      "id": "terraform_image",
      "type": "pickString",
      "description": "terraform docker image",
      "options": [
        "registry.gitlab.com/pl.rachuna-net/containers/terraform:1.0.0",
        "registry.gitlab.com/pl.rachuna-net/containers/terraform:1.0.1",
        "registry.gitlab.com/pl.rachuna-net/containers/terraform:1.0.2"
      ],
      "default": "registry.gitlab.com/pl.rachuna-net/containers/terraform:1.0.2"
    },
    {
      "id": "vault_image",
      "type": "pickString",
      "description": "consul docker image",
      "options": [
        "registry.gitlab.com/pl.rachuna-net/containers/vault:1.0.0"
      ],
      "default": "registry.gitlab.com/pl.rachuna-net/containers/vault:1.0.0"
    }
  ]
}
